<<<<<<< HEAD
})
# Ahorro
calcularAhorro <- reactive({
edad_inicio <- input$edad_inicio
inflacion <- input$inflacion / 100
interes <- input$interes /100
edad_jubilacion <- input$edad_jubilacion
anios_aporte <- edad_jubilacion-edad_inicio
IVM <- 0.1106
crec_salarios <- 0.02154
salario0 <- input$salario *(1+ crec_salarios)^(-input$anio_inicio + (2024 - anios_aporte))
# Calculo del ahorro de un afiliado hasta su jubilación
i_12 <- (1+interes)^(1/12) - 1
Ahorro <- VSn(C = (salario0 * IVM) * annuity(i = i_12, n=12, type = "due"),
q = (1+crec_salarios) ,
n = anios_aporte,
i = interes,
type = "due")
return(Ahorro)
})
output$ahorro <- renderText({
paste("El ahorro es:", round(calcularAhorro(),1))
})
output$Naportes <- renderText({
paste("Aportó:", input$edad_jubilacion - input$edad_inicio, "años")
})
# Carga de las tablas de mortalidad
probsH<- unname(unlist(read_excel("Probabilidades_Ecuador_2023_2060.xlsx",
sheet=1)[,c(3)]))
probsM<- unname(unlist(read_excel("Probabilidades_Ecuador_2023_2060.xlsx",
sheet=2)[,c(3)]))
ls("package:lifecontingencies")
TH <- probs2lifetable(probs=probsH, radix=100000, type="qx", name = "Mortalidad Hombres")
TM <- probs2lifetable(probs=probsM, radix=100000, type="qx", name = "Mortalidad Mujeres")
# Cálculo del valor actual de las prestaciones a otorgarse
# Tasa de crecimiento del SBU= 2.5339%
# Tasa de crecimiento de pensiones= 1.8261%
load("C:/Users/MyHP/Desktop/TIC/Shiny-TIC/obtencion_pension_prom.Rdata")
# arreglo base de datos
#establecimiento minimo y maximo de pensiones
pensiones2 <- pensiones2 %>%  mutate( prom_salario_a_usar = promedio_sueldo_real *(1.02154)^(2024 - as.numeric(format(as.Date(fecha_inicial_pension, '%Y %m %d'), "%Y"))), .before=promedio_sueldo_real)
pensiones2 <- pensiones2 %>%  mutate(pension_final1 = pension_final *( 1.018261)^(2024 - as.numeric(format(as.Date(fecha_inicial_pension, '%Y %m %d'), "%Y"))), .before=pension_final)
pensiones2 <- pensiones2 %>% mutate(pensionesfinal2 = pension_final1)
pensiones2 <- pensiones2 %>% dplyr::filter(tipo_seguro != 'SC')
#Función de cálculo de la pensión promedio
pension_promedio_fun <- function(e_j, impo, sexo1, sal_ini, anios_aporte){
crec_salarios <- 0.02154
res <- pensiones2 %>%  dplyr::filter(minimo(input$edad_inicio) <=edad_jubilacion & edad_jubilacion <= e_j + 3) %>%
dplyr::filter(impo + 24 >= numero_imposiciones &  numero_imposiciones >= ((minimo(input$edad_inicio) - input$edad_inicio)*12) ) %>%
dplyr::filter(sexo == sexo1) %>%
mutate(prom_salario_a_usar1 = ifelse(prom_salario_a_usar ==0, mean(pensiones2$prom_salario_a_usar[pensiones2$prom_salario_a_usar !=0]),prom_salario_a_usar)) %>%
dplyr::filter( Pension(input$edad_inicio, sal_ini, anios_aporte)[[2]] - 300 <= prom_salario_a_usar1 & prom_salario_a_usar1 <= Pension(input$edad_inicio, sal_ini, anios_aporte)[[2]]+100)
#-300, -400
prom <- mean(res$pensionesfinal2)
return(prom)
}
calcularVApensiones <- reactive({
sexo <- input$sexo
edad_inicio <- input$edad_inicio
edad_jubilacion <- input$edad_jubilacion
n_pensiones <- 100 - edad_jubilacion # 100 años de edad como límite
anios_aporte <- edad_jubilacion-edad_inicio
crec_pensiones <- 1.8261/100
inflacion <- input$inflacion / 100
interes <- input$interes /100
crec_salarios <- 0.02154
salario <- input$salario *(1+ crec_salarios)^(-input$anio_inicio + (2024 - anios_aporte))
#Cálculo de la pensión promedio
#pension_promedio <- Pension(input$edad_inicio, input$salario, (input$edad_jubilacion - input$edad_inicio))[[1]]
pension_promedio <- pension_promedio_fun(edad_jubilacion, anios_aporte*12, sexo, salario, anios_aporte)
# Calculo del VA de la pension
i_12 <- (1+interes)^(1/12) - 1
C <- pension_promedio* annuity(i = i_12, n=12, type = "due")
if(sexo == 'M'){
va_pension <- C * axn(TH, x= edad_jubilacion, n=n_pensiones, i= (interes-crec_pensiones)/(1+crec_pensiones), payment='due')
}else{
va_pension <- C * axn(TM, x= edad_jubilacion, n=n_pensiones, i= (interes-crec_pensiones)/(1+crec_pensiones), payment='due')
}
pension <- pension_promedio
return(list(va_pension, pension))
})
output$VApension <- renderText({
paste("El valor actual actuarial de la pensión a otorgarse es: ", round(calcularVApensiones()[[1]],1))
})
output$cobertura <- renderText({
paste("Porcentaje con el que debe aportar el Estado Ecuatoriano para cubrir el pago de la pensión del individuo: ",
round(((calcularVApensiones()[[1]]- calcularAhorro())/calcularVApensiones()[[1]])*100,1), '%')
})
output$pensionpromedio <- renderText({
paste("La pensión promedio obtenida de la base de datos que recibirían es de: $ ", round(calcularVApensiones()[[2]],1))
})
output$pension_teorica_actual <- renderText({
paste("La pensión teórica que recibiría actualmente sin las reformas es: $",
round(Pension(input$edad_inicio, input$salario *(1+ 0.02154)^(-input$anio_inicio + (2024 - (input$edad_jubilacion - input$edad_inicio))), (input$edad_jubilacion - input$edad_inicio))[[1]], 2)
)
})
output$pension_teorica_jub <- renderText({
paste("La pensión teórica que recibiría al momento de su jubilación sin las reformas es: $",
round(Pension(input$edad_inicio, input$salario , (input$edad_jubilacion - input$edad_inicio))[[1]], 2)
)
})
output$pension_teorica_jub_o <- renderText({
paste("La pensión teórica que recibiría al momento de su jubilación capitalizando la pensión actual obtenida: $",
round((Pension(input$edad_inicio, input$salario *(1+ 0.02154)^(-input$anio_inicio + (2024 - (input$edad_jubilacion - input$edad_inicio))), (input$edad_jubilacion - input$edad_inicio))[[1]])*(1.018261 )^((input$edad_jubilacion-input$edad_inicio)- (2024 - input$anio_inicio)),2)
)
})
output$tasa_reemplazo <- renderText({
paste("La tasa de reemplazo es: ",
round( TasaReemplazo(input$edad_inicio, input$salario, (input$edad_jubilacion - input$edad_inicio)), 2)
)
})
# GRAFICO, CUÁNDO SE PRESENTA EL DÉFICIT DEPENDIENDO DEL APORTE DEL ESTADO DEL 10% AL 40%
# USO DE LA INFORMACIÓN DADA POR LA BASE DE DATOS PROPORCIONADA
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 10/100
i_12 <- (1+(10/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
t <- 1
max_iter <- 100
while((ahorro - pension) > 0 && t <= max_iter){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
t <- t+ 1
}
if (t > max_iter) {
return(100)
} else {
return(i)
}
}
}
output$deficit_porcentaje <- renderHighchart({
y <- c()
for (i in 0:40){
y <- c(y , fun_anio_deficit(80123, 123150 ,722 , i))
}
data <- data.frame(
x = seq(0, 40, by = 1),
y = y
)
# Crear gráfico de Highcharts
data %>%
hchart(.,
type = "line",styled = TRUE,
hcaes(x = x,
y = y)) %>%
hc_title(text = "Impacto del Porcentaje de Aportación del Estado en la Sostenibilidad de las Pensiones") %>%
hc_subtitle(text = "Análisis de Tendencias y Proyecciones") %>%
hc_xAxis(title = list(text = "Porcentaje de Aportación del Estado")) %>%
hc_yAxis(title = list(text = "Número de años antes de alcanzar el déficit")) %>%
hc_add_theme(hc_theme_darkunica())
})
y <- c()
for (i in 0:40){
y <- c(y , fun_anio_deficit(80123, 123150 ,722 , i))
}
data <- data.frame(
x = seq(0, 40, by = 1),
y = y
)
data
## SERVER ###
server <- function(input, output, session) {
# Verificar mínimo de edad de jubilación
edadmin <- reactive({
return(minimo(input$edad_inicio))
})
output$minjub <- renderText({
paste("La edad mínima de jubilación es:",edadmin() , "años")
})
# Ahorro
calcularAhorro <- reactive({
edad_inicio <- input$edad_inicio
inflacion <- input$inflacion / 100
interes <- input$interes /100
edad_jubilacion <- input$edad_jubilacion
anios_aporte <- edad_jubilacion-edad_inicio
IVM <- 0.1106
crec_salarios <- 0.02154
salario0 <- input$salario *(1+ crec_salarios)^(-input$anio_inicio + (2024 - anios_aporte))
# Calculo del ahorro de un afiliado hasta su jubilación
i_12 <- (1+interes)^(1/12) - 1
Ahorro <- VSn(C = (salario0 * IVM) * annuity(i = i_12, n=12, type = "due"),
q = (1+crec_salarios) ,
n = anios_aporte,
i = interes,
type = "due")
return(Ahorro)
})
output$ahorro <- renderText({
paste("El ahorro es:", round(calcularAhorro(),1))
})
output$Naportes <- renderText({
paste("Aportó:", input$edad_jubilacion - input$edad_inicio, "años")
})
# Carga de las tablas de mortalidad
probsH<- unname(unlist(read_excel("Probabilidades_Ecuador_2023_2060.xlsx",
sheet=1)[,c(3)]))
probsM<- unname(unlist(read_excel("Probabilidades_Ecuador_2023_2060.xlsx",
sheet=2)[,c(3)]))
ls("package:lifecontingencies")
TH <- probs2lifetable(probs=probsH, radix=100000, type="qx", name = "Mortalidad Hombres")
TM <- probs2lifetable(probs=probsM, radix=100000, type="qx", name = "Mortalidad Mujeres")
# Cálculo del valor actual de las prestaciones a otorgarse
# Tasa de crecimiento del SBU= 2.5339%
# Tasa de crecimiento de pensiones= 1.8261%
load("C:/Users/MyHP/Desktop/TIC/Shiny-TIC/obtencion_pension_prom.Rdata")
# arreglo base de datos
#establecimiento minimo y maximo de pensiones
pensiones2 <- pensiones2 %>%  mutate( prom_salario_a_usar = promedio_sueldo_real *(1.02154)^(2024 - as.numeric(format(as.Date(fecha_inicial_pension, '%Y %m %d'), "%Y"))), .before=promedio_sueldo_real)
pensiones2 <- pensiones2 %>%  mutate(pension_final1 = pension_final *( 1.018261)^(2024 - as.numeric(format(as.Date(fecha_inicial_pension, '%Y %m %d'), "%Y"))), .before=pension_final)
pensiones2 <- pensiones2 %>% mutate(pensionesfinal2 = pension_final1)
pensiones2 <- pensiones2 %>% dplyr::filter(tipo_seguro != 'SC')
#Función de cálculo de la pensión promedio
pension_promedio_fun <- function(e_j, impo, sexo1, sal_ini, anios_aporte){
crec_salarios <- 0.02154
res <- pensiones2 %>%  dplyr::filter(minimo(input$edad_inicio) <=edad_jubilacion & edad_jubilacion <= e_j + 3) %>%
dplyr::filter(impo + 24 >= numero_imposiciones &  numero_imposiciones >= ((minimo(input$edad_inicio) - input$edad_inicio)*12) ) %>%
dplyr::filter(sexo == sexo1) %>%
mutate(prom_salario_a_usar1 = ifelse(prom_salario_a_usar ==0, mean(pensiones2$prom_salario_a_usar[pensiones2$prom_salario_a_usar !=0]),prom_salario_a_usar)) %>%
dplyr::filter( Pension(input$edad_inicio, sal_ini, anios_aporte)[[2]] - 300 <= prom_salario_a_usar1 & prom_salario_a_usar1 <= Pension(input$edad_inicio, sal_ini, anios_aporte)[[2]]+100)
#-300, -400
prom <- mean(res$pensionesfinal2)
return(prom)
}
calcularVApensiones <- reactive({
sexo <- input$sexo
edad_inicio <- input$edad_inicio
edad_jubilacion <- input$edad_jubilacion
n_pensiones <- 100 - edad_jubilacion # 100 años de edad como límite
anios_aporte <- edad_jubilacion-edad_inicio
crec_pensiones <- 1.8261/100
inflacion <- input$inflacion / 100
interes <- input$interes /100
crec_salarios <- 0.02154
salario <- input$salario *(1+ crec_salarios)^(-input$anio_inicio + (2024 - anios_aporte))
#Cálculo de la pensión promedio
#pension_promedio <- Pension(input$edad_inicio, input$salario, (input$edad_jubilacion - input$edad_inicio))[[1]]
pension_promedio <- pension_promedio_fun(edad_jubilacion, anios_aporte*12, sexo, salario, anios_aporte)
# Calculo del VA de la pension
i_12 <- (1+interes)^(1/12) - 1
C <- pension_promedio* annuity(i = i_12, n=12, type = "due")
if(sexo == 'M'){
va_pension <- C * axn(TH, x= edad_jubilacion, n=n_pensiones, i= (interes-crec_pensiones)/(1+crec_pensiones), payment='due')
}else{
va_pension <- C * axn(TM, x= edad_jubilacion, n=n_pensiones, i= (interes-crec_pensiones)/(1+crec_pensiones), payment='due')
}
pension <- pension_promedio
return(list(va_pension, pension))
})
output$VApension <- renderText({
paste("El valor actual actuarial de la pensión a otorgarse es: ", round(calcularVApensiones()[[1]],1))
})
output$cobertura <- renderText({
paste("Porcentaje con el que debe aportar el Estado Ecuatoriano para cubrir el pago de la pensión del individuo: ",
round(((calcularVApensiones()[[1]]- calcularAhorro())/calcularVApensiones()[[1]])*100,1), '%')
})
output$pensionpromedio <- renderText({
paste("La pensión promedio obtenida de la base de datos que recibirían es de: $ ", round(calcularVApensiones()[[2]],1))
})
output$pension_teorica_actual <- renderText({
paste("La pensión teórica que recibiría actualmente sin las reformas es: $",
round(Pension(input$edad_inicio, input$salario *(1+ 0.02154)^(-input$anio_inicio + (2024 - (input$edad_jubilacion - input$edad_inicio))), (input$edad_jubilacion - input$edad_inicio))[[1]], 2)
)
})
output$pension_teorica_jub <- renderText({
paste("La pensión teórica que recibiría al momento de su jubilación sin las reformas es: $",
round(Pension(input$edad_inicio, input$salario , (input$edad_jubilacion - input$edad_inicio))[[1]], 2)
)
})
output$pension_teorica_jub_o <- renderText({
paste("La pensión teórica que recibiría al momento de su jubilación capitalizando la pensión actual obtenida: $",
round((Pension(input$edad_inicio, input$salario *(1+ 0.02154)^(-input$anio_inicio + (2024 - (input$edad_jubilacion - input$edad_inicio))), (input$edad_jubilacion - input$edad_inicio))[[1]])*(1.018261 )^((input$edad_jubilacion-input$edad_inicio)- (2024 - input$anio_inicio)),2)
)
})
output$tasa_reemplazo <- renderText({
paste("La tasa de reemplazo es: ",
round( TasaReemplazo(input$edad_inicio, input$salario, (input$edad_jubilacion - input$edad_inicio)), 2)
)
})
# GRAFICO, CUÁNDO SE PRESENTA EL DÉFICIT DEPENDIENDO DEL APORTE DEL ESTADO DEL 10% AL 40%
# USO DE LA INFORMACIÓN DADA POR LA BASE DE DATOS PROPORCIONADA
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 10/100
i_12 <- (1+(10/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
t <- 1
max_iter <- 100
while((ahorro - pension) > 0 && t <= max_iter){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
t <- t+ 1
}
if (t > max_iter) {
return(100)
} else {
return(i)
}
}
}
y <- c()
for (i in 0:40){
y <- c(y , fun_anio_deficit(8110123, 123150 ,722 , i))
}
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 10/100
i_12 <- (1+(10/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
while((ahorro - pension) > 0 && t <= max_iter){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
if (is.finite(ahorro)) {
return(100)
}
}
return(i)
}
y <- c()
for (i in 0:40){
y <- c(y , fun_anio_deficit(8110123, 123150 ,722 , i))
}
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 10/100
i_12 <- (1+(10/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
while((ahorro - pension) > 0){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
if (is.finite(ahorro)) {
return(100)
}
}
return(i)
}
y <- c()
for (i in 0:40){
y <- c(y , fun_anio_deficit(8110123, 123150 ,722 , i))
}
y
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 6.25/100
i_12 <- (1+(6.25/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
while((ahorro - pension) > 0){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
if (is.finite(ahorro)) {
return(100)
}
}
return(i)
}
y <- c()
for (i in 0:40){
y <- c(y , fun_anio_deficit(8110123, 123150 ,722 , i))
}
y
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 6.25/100
i_12 <- (1+(6.25/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
while((ahorro - pension) > 0){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
if (!is.finite(ahorro)) {
return(100)
}
}
return(i)
}
y <- c()
for (i in 0:40){
y <- c
y <- c()
for (i in 0:40){
y <- c(y , fun_anio_deficit(8110123, 123150 ,722 , i))
}
y
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 6.25/100
i_12 <- (1+(6.25/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
while((ahorro - pension) > 0){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
if (!is.finite(ahorro)) {
return(100)
}
}
return(i)
}
y <- c()
for (i in 0:40){
y <- c(y , fun_anio_deficit(8110123, 123150 ,722 , i))
}
y
if(is.finite(100)){print(199)}
if(!is.finite(100)){print(199)}
y <- c()
for (k in 0:40){
y <- c(y , fun_anio_deficit(80123, 123150 ,722 , k))
}
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 6.25/100
i_12 <- (1+(6.25/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
while((ahorro - pension) > 0){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
if (!is.finite(ahorro)) {
return(100)
}
}
return(i)
}
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 6.25/100
i_12 <- (1+(6.25/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
while((ahorro - pension) > 0){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
if (!is.finite(ahorro)) {
return(100)
}
}
return(i)
}
y <- c()
for (k in 0:40){
y <- c(y , fun_anio_deficit(80123, 123150 ,722 , k))
}
y
fun_anio_deficit<- function (ahorro, va_pensiones, pension_inicial, porcentaje_estado){
ahorro <- ahorro + (porcentaje_estado/100)* va_pensiones
crec_pensiones <- 1.8261/100
interes <- 10/100
i_12 <- (1+(10/100))^(1/12) - 1
pension <- pension_inicial * annuity(i = i_12, n=12, type = "due")
i <- 1
while((ahorro - pension) > 0){
ahorro <- (ahorro - pension)* (1 + interes)
pension <- pension * (1+ crec_pensiones)
i <- i + 1
if (!is.finite(ahorro)) {
return(100)
}
}
return(i)
}
y <- c()
y <- c()
for (k in 0:40){
y <- c(y , fun_anio_deficit(80123, 123150 ,722 , k))
}
y
runApp()
# Crear gráfico de Highcharts
data %>%
hchart(.,
type = "line",styled = TRUE,
name= 'Edad del jubilado',
hcaes(x = x,
y = y)) %>%
hc_title(text = "Impacto del Porcentaje de Aportación del Estado en la Sostenibilidad de las Pensiones") %>%
hc_subtitle(text = "Edad del jubilado donde se terminarían los recursos para el pago de su pensión según el porcentaje de aporte del Estado") %>%
hc_xAxis(title = list(text = "Porcentaje de Aportación del Estado")) %>%
hc_yAxis(title = list(text = "Edad del jubilado donde se alcanza el déficit")) %>%
hc_add_theme(hc_theme_elementary())
=======
<<<<<<< HEAD
shiny::runApp()
runApp()
shiny::runApp()
library(shinythemes)
runApp()
runApp()
runApp()
runApp()
TasaReemplazo <- function(edad, salario, anios_aporte){
if(salario > 460){incremento <- 0.021540}
else{incremento <- 0.025339 }
pension <- Pension(edad, salario, anios_aporte, incremento)
ultimo_sueldo <- salario * (1+incremento)^(anios_aporte - 1)
tasa <- (pension / ultimo_sueldo) * 100
return(tasa)
}
runApp()
runApp()
inflacion <- 0.02154
Pension(25,850, (65-25), 0.02154)
# Función para calculo de la pensión
Pension <- function(edad, salario, anios_aporte, inflacion){
# Creamos un vector con los últimos 5 mejores salarios
mejores_5_salarios <- sapply(1:5, function(i) {
salario * (1 + inflacion)^(anios_aporte - i)
})
# pension = promedio * coef
prom <- sum(mejores_5_salarios) / 5
coef <- Coeficiente$Coef[Coeficiente$An.Imposiciones == anios_aporte]
pension <- prom * coef
return(pension)
}
Pension(25,850, (65-25), 0.02154)
Coeficiente <- data.frame(An.Imposiciones = c(5:40),
Coef = c(0.4375, 0.4500, 0.4625,0.4750,
0.4875, 0.5000, 0.5125, 0.5250,
0.5375, 0.5500, 0.5625, 0.5750,
0.5875, 0.6000, 0.6125, 0.6250,
0.6375, 0.6500, 0.6625, 0.6750,
0.6875, 0.7000, 0.7125, 0.7250,
0.7375, 0.7500, 0.7625, 0.7750,
0.7875, 0.8000, 0.8125, 0.8325,
0.8605, 0.8970, 0.9430, 1.0000))
# Añadir nuevas filas para cuando supera los 40 años de aportes
for (i in 41:100) {
ultimo_coef <- tail(Coeficiente$Coef, 1)
nuevo_coef <- ultimo_coef + 0.0125
nueva_fila <- data.frame(An.Imposiciones = i, Coef = nuevo_coef)
Coeficiente <- rbind(Coeficiente, nueva_fila)
}
Pension(25,850, (65-25), 0.02154)
edad <- 25
salario <- 850
anios_aporte <- (65-25)
inflacion <- 0.02154
pension <- Pension(edad, salario, anios_aporte, inflacion)
pension
ultimo_sueldo <- salario * (1+inflacion)^(anios_aporte - 1)
ultimo_sueldo
tasa <- (pension / ultimo_sueldo) * 100
tasa
tasa
ultimo_sueldo/pension
=======
i = interes,
type = "due")
}
View(ev_res)
runApp()
View(ev_res)
runApp()
pen <- Pension(edad_inicio, salario_ini, num_anios)[[1]]
pen
ev_res <- data.frame(
anio = c(anio_ini:anio_fin),
edad = c(edad_inicio:(edad_jubilacion-1)),
res_acum = numeric(num_anios)
)
for (j in c(1:num_anios)) {
ev_res[j,3] <-  VSn(C = (salario_ini * IVM ),# * annuity(i = crec_salarios_12, n=12, type = "due"), #* (1+interes)^(j-1)
q = (1+crec_salarios) ,
n = j , #años de aporte hasta el momento
i = interes,
type = "due")
}
View(ev_res)
pen <- Pension(edad_inicio, salario_ini, num_anios)[[1]]
pen
ev_res2 <- data.frame(
anio = c((anio_fin+1):anio_muerte),
edad = c(edad_jubilacion:100),
res_acum = numeric(num_anios_pension)
)
View(ev_res2)
j=1
View(ev_res2)
axn(TH,
x = ev_res2[j,2],
n = 12,
i = crec_pensiones_12,
payment = "due")
pen*axn(TH,
x = ev_res2[j,2],
n = 12,
i = crec_pensiones_12,
payment = "due")
pen
ev_res[nrow(ev_res),3]
ev_res <- data.frame(
anio = c(anio_ini:anio_fin),
edad = c(edad_inicio:(edad_jubilacion-1)),
res_acum = numeric(num_anios)
)
for (j in c(1:num_anios)) {
ev_res[j,3] <-  VSn(C = (salario_ini * IVM ) * annuity(i = crec_salarios_12, n=12, type = "due"),
q = (1+crec_salarios) ,
n = j , #años de aporte hasta el momento
i = interes,
type = "due")
}
pen <- Pension(edad_inicio, salario_ini, num_anios)[[1]]
ev_res2 <- data.frame(
anio = c((anio_fin+1):anio_muerte),
edad = c(edad_jubilacion:100),
res_acum = numeric(num_anios_pension)
)
i_asterisco <- (interes-crec_pensiones)/(1+crec_pensiones)
j=1
ev_res[nrow(ev_res),3]
pen <- Pension(edad_inicio, salario_ini, num_anios)[[1]]
ev_res2 <- data.frame(
anio = c((anio_fin+1):anio_muerte),
edad = c(edad_jubilacion:100),
res_acum = numeric(num_anios_pension)
)
i_asterisco <- (interes-crec_pensiones)/(1+crec_pensiones)
for (j in c(1:num_anios_pension)) {
# j=1
#
# C <- pen*axn(TH,
#              x = ev_res2[j,2],
#              n = 12,
#              i = crec_pensiones_12,
#              payment = "due")
#
# ev_res2[j,3] <-  ev_res[nrow(ev_res),3] - C*axn(TH,
#                                               x = edad_jubilacion,
#                                               n = 100-ev_res2[j,2],
#                                               i = i_asterisco,
#                                               payment = "due")
ev_res2[j,3] <-  ev_res[nrow(ev_res),3] - pen*axn(TH,
x = ev_res2[j,2],
n = 12*(100-ev_res2[j,2]),
i = crec_pensiones_12,
payment = "due")
}
View(ev_res2)
View(ev_res)
j=1
ev_res2[j,2]
100-ev_res2[j,2]
j=2
100-ev_res2[j,2]
ev_res2[j,2]
j=1
ev_res2[j,2]
ev_res2[j,2]-edad_jubilacion
ev_res2[j,2]-edad_jubilacion+1
j=2
ev_res2[j,2]-edad_jubilacion+1
# Cálculo de la renta actuarial prepagable
## !!!!!!!!!!!!!!!!!!!!!!!!!  NO ESTÁ CORREGIDA !!!!!!!!!!!!!!!!!!!!!!!
axn_m <- function(TH,x,n,m,i,k=0,payment="due"){#pordefecto pre
if(payment == "due"){
ax<- axn(TH,x=x,n=n,i=i,payment = "due")- ((m-1)/(2*m))*(31-Exn(TH,x=x,n=n,i=i))
return(ax)
} else {
ax <- axn(TH,x=x,n=n,i=i,payment = "due")- ((m+1)/(2*m))*(1-Exn(TH,x=x,n=n,i=i))
return(ax)
}
}
ev_res2[j,2]-edad_jubilacion+1
pen <- Pension(edad_inicio, salario_ini, num_anios)[[1]]
ev_res2 <- data.frame(
anio = c((anio_fin+1):anio_muerte),
edad = c(edad_jubilacion:100),
res_acum = numeric(num_anios_pension)
)
i_asterisco <- (interes-crec_pensiones)/(1+crec_pensiones)
for (j in c(1:num_anios_pension)) {
# j=2
#
# C <- pen*axn(TH,
#              x = ev_res2[j,2],
#              n = 12,
#              i = crec_pensiones_12,
#              payment = "due")
#
# ev_res2[j,3] <-  ev_res[nrow(ev_res),3] - C*axn(TH,
#                                               x = edad_jubilacion,
#                                               n = 100-ev_res2[j,2],
#                                               i = i_asterisco,
#                                               payment = "due")
ev_res2[j,3] <-  ev_res[nrow(ev_res),3] - pen*12*axn_m(TH,
x=edad_jubilacion,
n=ev_res2[j,2]-edad_jubilacion+1,
m = 12,
i = crec_pensiones ,
k=0,
payment="due")
}
View(ev_res2)
127611.9618
293989.35
127612 - 293989.35
ev_res[nrow(ev_res),3]
j=1
pen*12*axn_m(TH,
x=edad_jubilacion,
n=ev_res2[j,2]-edad_jubilacion+1,
m = 12,
i = crec_pensiones ,
k=0,
payment="due")
axn_m(TH,
x=edad_jubilacion,
n=ev_res2[j,2]-edad_jubilacion+1,
m = 12,
i = crec_pensiones ,
k=0,
payment="due")
axn_m(TH = TH,x = 50,n = 5,m = 12,k=0,i = 0.085,payment = "immediate")
edad_jubilacion
ev_res2[j,2]-edad_jubilacion+1
12
crec_pensiones
axn_m(TH = TH,x=edad_jubilacion, n=ev_res2[j,2]-edad_jubilacion+1, m = 12, i = crec_pensiones , k=0,payment="due")
ev_res2[j,2]-edad_jubilacion+1
axn(TH,x=edad_jubilacion,n=ev_res2[j,2]-edad_jubilacion+1,i=crec_pensiones,payment = "due")
((12-1)/(2*12))*(1-Exn(TH,x=edad_jubilacion,n=ev_res2[j,2]-edad_jubilacion+1,i=crec_pensiones))
axn(TH,x=edad_jubilacion,n=ev_res2[j,2]-edad_jubilacion+1,i=crec_pensiones,payment = "due")- ((12-1)/(2*12))*(1-Exn(TH,x=edad_jubilacion,n=ev_res2[j,2]-edad_jubilacion+1,i=crec_pensiones))
x=edad_jubilacion,
x=edad_jubilacion
n=ev_res2[j,2]-edad_jubilacion+1
m = 12
i = crec_pensiones
i
axn(TH,x=x,n=n,i=i,payment = "due")
((m-1)/(2*m))*(1-Exn(TH,x=x,n=n,i=i))
axn(TH,x=x,n=n,i=i,payment = "due")- ((m-1)/(2*m))*(1-Exn(TH,x=x,n=n,i=i))
axn_m(TH, x=edad_jubilacion, n=ev_res2[j,2]-edad_jubilacion+1,m = 12,i = crec_pensiones ,k=0,payment="due")
axn(TH,x=x,n=n,i=i,payment = "due")- ((m-1)/(2*m))*(1-Exn(TH,x=x,n=n,i=i))
j=1
ev_res2[j,3]
ev_res[nrow(ev_res),3]
pen*12*axn(TH,x=x,n=n,i=i,payment = "due")- ((m-1)/(2*m))*(1-Exn(TH,x=x,n=n,i=i))
edad_inicio <- 25
edad_jubilacion <- 60
salario_ini <- 600
crec_pensiones <- 1.8261/100; crec_pensiones_12 <- (1+crec_pensiones)^(1/12)-1
interes <- 6.2500 /100 #tasa actuarial
crec_salarios <- 0.02154; crec_salarios_12 <- (1+crec_salarios)^(1/12)-1 #superiodal
IVM <- 11.06/100
anio_ini <- 2010
anio_fin <- anio_ini + (edad_jubilacion-edad_inicio-1)
num_anios <- edad_jubilacion - edad_inicio
anio_muerte <- anio_fin+1 + (100-edad_jubilacion)
num_anios_pension <- length(c((anio_fin+1):anio_muerte))
# Crecimiento de la reserva ( cotizaciones ) -----------------------------------
ev_res <- data.frame(
anio = c(anio_ini:anio_fin),
edad = c(edad_inicio:(edad_jubilacion-1)),
res_acum = numeric(num_anios)
)
for (j in c(1:num_anios)) {
ev_res[j,3] <-  VSn(C = (salario_ini * IVM ) * annuity(i = crec_salarios_12, n=12, type = "due"),
q = (1+crec_salarios) ,
n = j , #años de aporte hasta el momento
i = interes,
type = "due")
}
View(ev_res)
pen <- Pension(edad_inicio, salario_ini, num_anios)[[1]]
pen
ev_res2 <- data.frame(
anio = c((anio_fin+1):anio_muerte),
edad = c(edad_jubilacion:100),
res_acum = numeric(num_anios_pension)
)
i_asterisco <- (interes-crec_pensiones)/(1+crec_pensiones)
for (j in c(1:num_anios_pension)) {
x=edad_jubilacion
n=ev_res2[j,2]-edad_jubilacion+1
m = 12
i = crec_pensiones
ev_res2[j,3] <-  ev_res[nrow(ev_res),3] - pen*12*axn(TH,x=x,n=n,i=i,payment = "due")- ((m-1)/(2*m))*(1-Exn(TH,x=x,n=n,i=i))
}
View(ev_res2)
edad <- c(ev_res[,2],ev_res2[,2])
reservas <- c(ev_res[,3],ev_res2[,3])
highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Evolución de Reservas por Edad") %>%
hc_xAxis(categories = edad, title = list(text = "Edad")) %>%
hc_yAxis(title = list(text = "Reservas")) %>%
hc_tooltip(shared = TRUE, valueDecimals = 0) %>%
hc_plotOptions(area = list(
marker = list(enabled = FALSE),
enableMouseTracking = TRUE
)) %>%
hc_add_series(
name = "Aportación",
data = reservas[1:35],  # datos positivos hasta 150000
color = "blue",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación",
data = c(rep(NA, 34), reservas[35:75]),  # datos decreciendo de 150000 a 0
color = "green",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación -",
data = c(rep(NA, 75), reservas[76:length(reservas)]),  # datos decreciendo de 0 a -150000
color = "red",
fillOpacity=0.3
)
runApp()
94/127
c(ev_res[,2],ev_res2[,2])
c(ev_res[,3],ev_res2[,3])
>>>>>>> 81355fc748ea39a28842280ee6729b61176339ee
runApp()
runApp()
list(edad,reservas)
list(edad,reservas)[[1]]
class(list(edad,reservas)[[1]])
typeof(list(edad,reservas)[[1]])
length(list(edad,reservas)[[1]])
max(which(reservas > 0))
min(which(reservas < 0))
reservas
which(max(reservas))
reservas
max(reservas)
which(reservas==max(reservas))
runApp()
max_res <- which(reservas==max(reservas))
last_pos <- max(which(reservas > 0))
first_neg <- min(which(reservas < 0))
highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Evolución de Reservas por Edad") %>%
hc_xAxis(categories = edad, title = list(text = "Edad")) %>%
hc_yAxis(title = list(text = "Reservas")) %>%
hc_tooltip(shared = TRUE, valueDecimals = 0) %>%
hc_plotOptions(area = list(
marker = list(enabled = FALSE),
enableMouseTracking = TRUE
)) %>%
hc_add_series(
name = "Aportación",
data = reservas[1:max_res],  # datos positivos hasta 150000
color = "blue",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación",
data = c(rep(NA, max_res-1), reservas[max_res:last_pos]),  # datos decreciendo de 150000 a 0
color = "green",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación -",
data = c(rep(NA, last_pos), reservas[(last_pos+1):length(reservas)]),  # datos decreciendo de 0 a -150000
color = "red",
fillOpacity=0.3
)
highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Evolución de Reservas por Edad") %>%
hc_xAxis(categories = edad, title = list(text = "Edad")) %>%
hc_yAxis(title = list(text = "Reservas")) %>%
hc_tooltip(shared = TRUE, valueDecimals = 0) %>%
hc_plotOptions(area = list(
marker = list(enabled = FALSE),
enableMouseTracking = TRUE
)) %>%
hc_add_series(
name = "Aportación",
data = reservas[1:max_res],  # datos positivos hasta 150000
color = "blue",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación",
data = c(rep(NA, max_res-1), reservas[max_res:last_pos]),  # datos decreciendo de 150000 a 0
color = "green",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación -",
data = c(rep(NA, last_pos), reservas[(last_pos):length(reservas)]),  # datos decreciendo de 0 a -150000
color = "red",
fillOpacity=0.3
)
highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Evolución de Reservas por Edad") %>%
hc_xAxis(categories = edad, title = list(text = "Edad")) %>%
hc_yAxis(title = list(text = "Reservas")) %>%
hc_tooltip(shared = TRUE, valueDecimals = 0) %>%
hc_plotOptions(area = list(
marker = list(enabled = FALSE),
enableMouseTracking = TRUE
)) %>%
hc_add_series(
name = "Aportación",
data = reservas[1:max_res],  # datos positivos hasta 150000
color = "blue",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación",
data = c(rep(NA, max_res-1), reservas[max_res:last_pos]),  # datos decreciendo de 150000 a 0
color = "green",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación -",
data = c(rep(NA, last_pos), reservas[(last_pos+1):length(reservas)]),  # datos decreciendo de 0 a -150000
color = "red",
fillOpacity=0.3
)
highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Evolución de Reservas por Edad") %>%
hc_xAxis(categories = edad, title = list(text = "Edad")) %>%
hc_yAxis(title = list(text = "Reservas")) %>%
hc_tooltip(shared = TRUE, valueDecimals = 0) %>%
hc_plotOptions(area = list(
marker = list(enabled = FALSE),
enableMouseTracking = TRUE
)) %>%
hc_add_series(
name = "Aportación",
data = reservas[1:max_res],  # datos positivos hasta 150000
color = "blue",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación",
data = c(rep(NA, max_res-1), reservas[max_res:last_pos]),  # datos decreciendo de 150000 a 0
color = "green",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación -",
data = c(rep(NA, last_pos-1), reservas[(last_pos+1):length(reservas)]),  # datos decreciendo de 0 a -150000
color = "red",
fillOpacity=0.3
)
highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Evolución de Reservas por Edad") %>%
hc_xAxis(categories = edad, title = list(text = "Edad")) %>%
hc_yAxis(title = list(text = "Reservas")) %>%
hc_tooltip(shared = TRUE, valueDecimals = 0) %>%
hc_plotOptions(area = list(
marker = list(enabled = FALSE),
enableMouseTracking = TRUE
)) %>%
hc_add_series(
name = "Aportación",
data = reservas[1:max_res],  # datos positivos hasta 150000
color = "blue",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación",
data = c(rep(NA, max_res-1), reservas[max_res:last_pos]),  # datos decreciendo de 150000 a 0
color = "green",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación -",
data = c(rep(NA, last_pos), reservas[(last_pos+1):length(reservas)]),  # datos decreciendo de 0 a -150000
color = "red",
fillOpacity=0.3
)
highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Evolución de Reservas por Edad") %>%
hc_xAxis(categories = edad, title = list(text = "Edad")) %>%
hc_yAxis(title = list(text = "Reservas")) %>%
hc_tooltip(shared = TRUE, valueDecimals = 0) %>%
hc_plotOptions(area = list(
marker = list(enabled = FALSE),
enableMouseTracking = TRUE
)) %>%
hc_add_series(
name = "Aportación",
data = reservas[1:max_res],  # datos positivos hasta 150000
color = "blue",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación",
data = c(rep(NA, max_res-1), reservas[max_res:last_pos]),  # datos decreciendo de 150000 a 0
color = "green",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación -",
data = c(rep(NA, last_pos), reservas[(last_pos):length(reservas)]),  # datos decreciendo de 0 a -150000
color = "red",
fillOpacity=0.3
)
highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Evolución de Reservas por Edad") %>%
hc_xAxis(categories = edad, title = list(text = "Edad")) %>%
hc_yAxis(title = list(text = "Reservas")) %>%
hc_tooltip(shared = TRUE, valueDecimals = 0) %>%
hc_plotOptions(area = list(
marker = list(enabled = FALSE),
enableMouseTracking = TRUE
)) %>%
hc_add_series(
name = "Aportación",
data = reservas[1:max_res],  # datos positivos hasta 150000
color = "blue",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación",
data = c(rep(NA, max_res-1), reservas[max_res:last_pos]),  # datos decreciendo de 150000 a 0
color = "green",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación -",
data = c(rep(NA, last_pos-1), reservas[(last_pos+1):length(reservas)]),  # datos decreciendo de 0 a -150000
color = "red",
fillOpacity=0.3
)
highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Evolución de Reservas por Edad") %>%
hc_xAxis(categories = edad, title = list(text = "Edad")) %>%
hc_yAxis(title = list(text = "Reservas")) %>%
hc_tooltip(shared = TRUE, valueDecimals = 0) %>%
hc_plotOptions(area = list(
marker = list(enabled = FALSE),
enableMouseTracking = TRUE
)) %>%
hc_add_series(
name = "Aportación",
data = reservas[1:max_res],  # datos positivos hasta 150000
color = "blue",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación",
data = c(rep(NA, max_res-1), reservas[max_res:last_pos]),  # datos decreciendo de 150000 a 0
color = "green",
fillOpacity = 0.3
) %>%
hc_add_series(
name = "Jubilación -",
data = c(rep(NA, last_pos-1), reservas[(last_pos):length(reservas)]),  # datos decreciendo de 0 a -150000
color = "red",
fillOpacity=0.3
)
runApp()
>>>>>>> e841d4cf11b4e03d67997666162646f6445b7929
runApp()
<<<<<<< HEAD
runApp()
runApp()
=======
>>>>>>> 81355fc748ea39a28842280ee6729b61176339ee
